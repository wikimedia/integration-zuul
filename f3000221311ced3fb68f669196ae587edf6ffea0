{
  "comments": [
    {
      "key": {
        "uuid": "6e7c4fa4_19e2342e",
        "filename": "debian/docs",
        "patchSetId": 12
      },
      "lineNbr": 1,
      "author": {
        "id": 1629
      },
      "writtenOn": "2015-03-26T10:31:56Z",
      "side": 1,
      "message": "remove the file?",
      "revId": "f3000221311ced3fb68f669196ae587edf6ffea0",
      "serverId": "e9e9afe9-4712-486d-8885-f54b72dd1951",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "6e7c4fa4_f9f898be",
        "filename": "debian/docs",
        "patchSetId": 12
      },
      "lineNbr": 1,
      "author": {
        "id": 24
      },
      "writtenOn": "2015-03-26T11:32:43Z",
      "side": 1,
      "message": "Done",
      "parentUuid": "6e7c4fa4_19e2342e",
      "revId": "f3000221311ced3fb68f669196ae587edf6ffea0",
      "serverId": "e9e9afe9-4712-486d-8885-f54b72dd1951",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "6e7c4fa4_59f42ced",
        "filename": "debian/gbp.conf",
        "patchSetId": 12
      },
      "lineNbr": 7,
      "author": {
        "id": 1629
      },
      "writtenOn": "2015-03-26T10:31:56Z",
      "side": 1,
      "message": "not sure this is right, it should be a branch name like \"master\" not HEAD",
      "revId": "f3000221311ced3fb68f669196ae587edf6ffea0",
      "serverId": "e9e9afe9-4712-486d-8885-f54b72dd1951",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "6e7c4fa4_f90f38d6",
        "filename": "debian/gbp.conf",
        "patchSetId": 12
      },
      "lineNbr": 7,
      "author": {
        "id": 24
      },
      "writtenOn": "2015-03-26T11:32:43Z",
      "side": 1,
      "message": "That is merely a hack to avoid having to pass  --git-debian-branch\u003d\u003cwhatever branch I am working on\u003e.  The repository branches in our repository are:\n\n master: a fork of upstream with some patches pending review on their side. Does not have a /debian/ directory\n upstream: upstream code we are based on\n\nThen I have created a branch for each debian package:\n\n debian/precise-wikimedia A merge of upstream + debian repository containing our pending patches as quilt patches in debian/patches\n debian/trusty-wikimedia Ditto but for our Trusty.\n\nBoth debian/* branches have  debian-branch \u003d HEAD so on my machine I would:\n\n git checkout debian/precise-wikimedia\n DEB_BUILD_OPTIONS\u003dnocheck git-buildpackage --git-dist\u003dprecise-wikimedia --git-pbuilder\n\nThen to build the trusty one, I s/precise/wikimedia/\n\n git checkout debian/trusty-wikimedia\n DEB_BUILD_OPTIONS\u003dnocheck git-buildpackage --git-dist\u003dtrusty-wikimedia --git-pbuilder\n\nI guess I could adjust my workflow to pass --git-debian-branch\u003dHEAD or the actual branch name.  But that is one more parameter to handle for my confused brain :-)",
      "parentUuid": "6e7c4fa4_59f42ced",
      "revId": "f3000221311ced3fb68f669196ae587edf6ffea0",
      "serverId": "e9e9afe9-4712-486d-8885-f54b72dd1951",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "6e7c4fa4_7960082e",
        "filename": "debian/gbp.conf",
        "patchSetId": 12
      },
      "lineNbr": 7,
      "author": {
        "id": 1629
      },
      "writtenOn": "2015-03-26T12:03:00Z",
      "side": 1,
      "message": "I suspect you can get away with a single debian branch, do they differ much?",
      "parentUuid": "6e7c4fa4_f90f38d6",
      "revId": "f3000221311ced3fb68f669196ae587edf6ffea0",
      "serverId": "e9e9afe9-4712-486d-8885-f54b72dd1951",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "6e7c4fa4_d9dd9ce3",
        "filename": "debian/gbp.conf",
        "patchSetId": 12
      },
      "lineNbr": 7,
      "author": {
        "id": 24
      },
      "writtenOn": "2015-03-26T12:27:02Z",
      "side": 1,
      "message": "The only changes are the dependencies in the debian/control file.  Some package are available in Trusty with the appropriate version so I have uncommented a few of them.  Beside that no differences.\n\nCan we do if else in control?  Or define several source packages having different Build-Deps?\n\nNote the packaging for Debian/Sid would no more use dh-virtualenv so it will have much more differences.",
      "parentUuid": "6e7c4fa4_7960082e",
      "revId": "f3000221311ced3fb68f669196ae587edf6ffea0",
      "serverId": "e9e9afe9-4712-486d-8885-f54b72dd1951",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "6e7c4fa4_272b3e30",
        "filename": "debian/gbp.conf",
        "patchSetId": 12
      },
      "lineNbr": 7,
      "author": {
        "id": 1629
      },
      "writtenOn": "2015-03-27T10:17:13Z",
      "side": 1,
      "message": "ack, I think that\u0027s fine for now but please stick a comment in there explaining why just so it is clear",
      "parentUuid": "6e7c4fa4_d9dd9ce3",
      "revId": "f3000221311ced3fb68f669196ae587edf6ffea0",
      "serverId": "e9e9afe9-4712-486d-8885-f54b72dd1951",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "6e7c4fa4_932a7329",
        "filename": "debian/gbp.conf",
        "patchSetId": 12
      },
      "lineNbr": 7,
      "author": {
        "id": 24
      },
      "writtenOn": "2015-04-01T13:01:01Z",
      "side": 1,
      "message": "Done in PS15, I have added:\n\n # source and /debian/ are in the same tree and we have a branch per repository.\n # To avoid having to pass -git-debian-branch when checking out branches, just\n # point to HEAD which has the appropriate /debian/\n debian-branch \u003d HEAD",
      "parentUuid": "6e7c4fa4_272b3e30",
      "revId": "f3000221311ced3fb68f669196ae587edf6ffea0",
      "serverId": "e9e9afe9-4712-486d-8885-f54b72dd1951",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "6e7c4fa4_99d88459",
        "filename": "debian/gbp.conf",
        "patchSetId": 12
      },
      "lineNbr": 9,
      "author": {
        "id": 24
      },
      "writtenOn": "2015-03-26T11:32:43Z",
      "side": 1,
      "message": "Getting rid of those. git-buildpackage default to upstream and the upstream source we care about is in the upstream branch.  Though one will need to have it checked out and up-to-date.",
      "revId": "f3000221311ced3fb68f669196ae587edf6ffea0",
      "serverId": "e9e9afe9-4712-486d-8885-f54b72dd1951",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "6e7c4fa4_79f9e8e3",
        "filename": "debian/install",
        "patchSetId": 12
      },
      "lineNbr": 1,
      "author": {
        "id": 1629
      },
      "writtenOn": "2015-03-26T10:31:56Z",
      "side": 1,
      "message": "remove the file?",
      "revId": "f3000221311ced3fb68f669196ae587edf6ffea0",
      "serverId": "e9e9afe9-4712-486d-8885-f54b72dd1951",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "6e7c4fa4_59de6c44",
        "filename": "debian/install",
        "patchSetId": 12
      },
      "lineNbr": 1,
      "author": {
        "id": 24
      },
      "writtenOn": "2015-03-26T11:32:43Z",
      "side": 1,
      "message": "Left over from a previous package attempt. We were copying there a bunch of example etc files. Found it is better to populate ours via puppet.\n\nDone.",
      "parentUuid": "6e7c4fa4_79f9e8e3",
      "revId": "f3000221311ced3fb68f669196ae587edf6ffea0",
      "serverId": "e9e9afe9-4712-486d-8885-f54b72dd1951",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "6e7c4fa4_39dff06d",
        "filename": "debian/prerm",
        "patchSetId": 12
      },
      "lineNbr": 22,
      "author": {
        "id": 1629
      },
      "writtenOn": "2015-03-26T10:31:56Z",
      "side": 1,
      "message": "no path needed into the virtualenv here?",
      "revId": "f3000221311ced3fb68f669196ae587edf6ffea0",
      "serverId": "e9e9afe9-4712-486d-8885-f54b72dd1951",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "6e7c4fa4_19ec74f1",
        "filename": "debian/prerm",
        "patchSetId": 12
      },
      "lineNbr": 22,
      "author": {
        "id": 24
      },
      "writtenOn": "2015-03-26T11:32:43Z",
      "side": 1,
      "message": "Good catch!",
      "parentUuid": "6e7c4fa4_39dff06d",
      "revId": "f3000221311ced3fb68f669196ae587edf6ffea0",
      "serverId": "e9e9afe9-4712-486d-8885-f54b72dd1951",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "6e7c4fa4_b960e0a0",
        "filename": "debian/rules",
        "patchSetId": 12
      },
      "lineNbr": 45,
      "author": {
        "id": 1629
      },
      "writtenOn": "2015-03-26T10:31:56Z",
      "side": 1,
      "message": "couple of things:\n- not sure removing these is necessary, the real sources are shipped anyway in the virtualenv in site-packages\n- OTOH the python binary can be removed and it\u0027ll get copied upon installation inside the virtualenv IIRC?",
      "revId": "f3000221311ced3fb68f669196ae587edf6ffea0",
      "serverId": "e9e9afe9-4712-486d-8885-f54b72dd1951",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "6e7c4fa4_3997f04c",
        "filename": "debian/rules",
        "patchSetId": 12
      },
      "lineNbr": 45,
      "author": {
        "id": 24
      },
      "writtenOn": "2015-03-26T11:32:43Z",
      "side": 1,
      "message": "\u003e not sure removing these is necessary, the real sources are shipped anyway in the virtualenv in site-packages\n\nThe activate* easy_install* pip* are copied by dh-virtualenv and we do not need them at all. So I am getting rid of the files to avoid shipping unneeded files. I think it generated some lintian errors as well.\nI have added the deletion of bin/pybabel which we dont need either.\n\nThe pyc file have to be generated on postinst so we don\u0027t want to ship them in the package.\n\n\n\u003e OTOH the python binary can be removed and it\u0027ll get copied upon installation inside the virtualenv IIRC?\n\nThe dh-virtualenv is run before and already copied the python2.7 binary. I found a trick: next patchset deletes it so it is no more in the .deb package then I just copy it from /usr/bin/python2.7 in postinst if it does not exist.",
      "parentUuid": "6e7c4fa4_b960e0a0",
      "revId": "f3000221311ced3fb68f669196ae587edf6ffea0",
      "serverId": "e9e9afe9-4712-486d-8885-f54b72dd1951",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "6e7c4fa4_99c40413",
        "filename": "debian/rules",
        "patchSetId": 12
      },
      "lineNbr": 45,
      "author": {
        "id": 1629
      },
      "writtenOn": "2015-03-26T12:03:00Z",
      "side": 1,
      "message": "re: activate and friends, I don\u0027t see the point of just removing them from bin while the actual python code is in site-packages\n\nre: the binary, yeah that\u0027s what I was suggesting (and failed to communicate it)",
      "parentUuid": "6e7c4fa4_3997f04c",
      "revId": "f3000221311ced3fb68f669196ae587edf6ffea0",
      "serverId": "e9e9afe9-4712-486d-8885-f54b72dd1951",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "6e7c4fa4_79e6c8ac",
        "filename": "debian/rules",
        "patchSetId": 12
      },
      "lineNbr": 45,
      "author": {
        "id": 24
      },
      "writtenOn": "2015-03-26T12:27:02Z",
      "side": 1,
      "message": "Ok keeping the activate / easy_install stuff :)\n\nI am quite happy the embedded python2.7 binary is gone. Thanks!",
      "parentUuid": "6e7c4fa4_99c40413",
      "revId": "f3000221311ced3fb68f669196ae587edf6ffea0",
      "serverId": "e9e9afe9-4712-486d-8885-f54b72dd1951",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "6e7c4fa4_b9da2076",
        "filename": "debian/zuul-merger.init",
        "patchSetId": 12
      },
      "lineNbr": 2,
      "author": {
        "id": 1629
      },
      "writtenOn": "2015-03-26T10:31:56Z",
      "side": 1,
      "message": "zuul-merger",
      "revId": "f3000221311ced3fb68f669196ae587edf6ffea0",
      "serverId": "e9e9afe9-4712-486d-8885-f54b72dd1951",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "6e7c4fa4_b9922055",
        "filename": "debian/zuul-merger.init",
        "patchSetId": 12
      },
      "lineNbr": 2,
      "author": {
        "id": 24
      },
      "writtenOn": "2015-03-26T11:32:43Z",
      "side": 1,
      "message": "Done and I have updated our puppet manifest https://gerrit.wikimedia.org/r/#/c/199852/",
      "parentUuid": "6e7c4fa4_b9da2076",
      "revId": "f3000221311ced3fb68f669196ae587edf6ffea0",
      "serverId": "e9e9afe9-4712-486d-8885-f54b72dd1951",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "6e7c4fa4_59cbcca8",
        "filename": "debian/zuul-merger.init",
        "patchSetId": 12
      },
      "lineNbr": 8,
      "author": {
        "id": 1629
      },
      "writtenOn": "2015-03-26T10:31:56Z",
      "side": 1,
      "message": "ditto",
      "revId": "f3000221311ced3fb68f669196ae587edf6ffea0",
      "serverId": "e9e9afe9-4712-486d-8885-f54b72dd1951",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "6e7c4fa4_5983cc07",
        "filename": "debian/zuul-merger.init",
        "patchSetId": 12
      },
      "lineNbr": 8,
      "author": {
        "id": 24
      },
      "writtenOn": "2015-03-26T11:32:43Z",
      "side": 1,
      "message": "Done and I have updated our puppet manifest https://gerrit.wikimedia.org/r/#/c/199852/",
      "parentUuid": "6e7c4fa4_59cbcca8",
      "revId": "f3000221311ced3fb68f669196ae587edf6ffea0",
      "serverId": "e9e9afe9-4712-486d-8885-f54b72dd1951",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "6e7c4fa4_79d00854",
        "filename": "debian/zuul-merger.init",
        "patchSetId": 12
      },
      "lineNbr": 39,
      "author": {
        "id": 1629
      },
      "writtenOn": "2015-03-26T10:31:56Z",
      "side": 1,
      "message": "do you really need to fail here as opposed to set defaults before sourcing /etc/default/$NAME ?",
      "revId": "f3000221311ced3fb68f669196ae587edf6ffea0",
      "serverId": "e9e9afe9-4712-486d-8885-f54b72dd1951",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "6e7c4fa4_998c0434",
        "filename": "debian/zuul-merger.init",
        "patchSetId": 12
      },
      "lineNbr": 39,
      "author": {
        "id": 24
      },
      "writtenOn": "2015-03-26T11:32:43Z",
      "side": 1,
      "message": "I have borrowed that from a random init script.  Should we have some sane defaults defined in the init script before attempting to load /etc/default/zuul-merger ? I can imagine something like:\n\n START_DAEMON\u003d0\n DAEMON_ARGS\u003d\u0027\u0027\n [ -r /etc/default/$NAME ] \u0026\u0026  . /etc/default/$NAME\n\nBut I am afraid (I | we) will forget to keep in sync the defaults in the init script and the default file.  Maybe I am overthinking.",
      "parentUuid": "6e7c4fa4_79d00854",
      "revId": "f3000221311ced3fb68f669196ae587edf6ffea0",
      "serverId": "e9e9afe9-4712-486d-8885-f54b72dd1951",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "6e7c4fa4_b9c9c02a",
        "filename": "debian/zuul-merger.init",
        "patchSetId": 12
      },
      "lineNbr": 39,
      "author": {
        "id": 1629
      },
      "writtenOn": "2015-03-26T12:03:00Z",
      "side": 1,
      "message": "which init script? it shouldn\u0027t fail if /etc/default isn\u0027t there but use sensible defaults instead, the way you are suggesting is fine I think",
      "parentUuid": "6e7c4fa4_998c0434",
      "revId": "f3000221311ced3fb68f669196ae587edf6ffea0",
      "serverId": "e9e9afe9-4712-486d-8885-f54b72dd1951",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "6e7c4fa4_b9f0e062",
        "filename": "debian/zuul-merger.init",
        "patchSetId": 12
      },
      "lineNbr": 39,
      "author": {
        "id": 24
      },
      "writtenOn": "2015-03-26T12:27:02Z",
      "side": 1,
      "message": "I have bothered it from /etc/init.d/minissdpd\n\nI have amended the change to provide sane default and pushed an update to our puppet repo: https://gerrit.wikimedia.org/r/#/c/199861/1",
      "parentUuid": "6e7c4fa4_b9c9c02a",
      "revId": "f3000221311ced3fb68f669196ae587edf6ffea0",
      "serverId": "e9e9afe9-4712-486d-8885-f54b72dd1951",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "6e7c4fa4_f9e41838",
        "filename": "debian/zuul-merger.init",
        "patchSetId": 12
      },
      "lineNbr": 99,
      "author": {
        "id": 1629
      },
      "writtenOn": "2015-03-26T10:31:56Z",
      "side": 1,
      "message": "(here and elsewhere) you can use $NAME",
      "revId": "f3000221311ced3fb68f669196ae587edf6ffea0",
      "serverId": "e9e9afe9-4712-486d-8885-f54b72dd1951",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "6e7c4fa4_d9befcfa",
        "filename": "debian/zuul.init",
        "patchSetId": 12
      },
      "lineNbr": 39,
      "author": {
        "id": 1629
      },
      "writtenOn": "2015-03-26T10:31:56Z",
      "side": 1,
      "message": "ditto, see comment for zuul-merger",
      "revId": "f3000221311ced3fb68f669196ae587edf6ffea0",
      "serverId": "e9e9afe9-4712-486d-8885-f54b72dd1951",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "6e7c4fa4_f9bbb807",
        "filename": "debian/zuul.triggers",
        "patchSetId": 12
      },
      "lineNbr": 4,
      "author": {
        "id": 1629
      },
      "writtenOn": "2015-03-26T10:31:56Z",
      "side": 1,
      "message": "do we care about 2.6?",
      "revId": "f3000221311ced3fb68f669196ae587edf6ffea0",
      "serverId": "e9e9afe9-4712-486d-8885-f54b72dd1951",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "6e7c4fa4_5992ec4e",
        "filename": "debian/zuul.triggers",
        "patchSetId": 12
      },
      "lineNbr": 4,
      "author": {
        "id": 24
      },
      "writtenOn": "2015-03-26T11:32:43Z",
      "side": 1,
      "message": "I have made the package python2.7 only so yeah removing python2.6 from the triggers :) Done.",
      "parentUuid": "6e7c4fa4_f9bbb807",
      "revId": "f3000221311ced3fb68f669196ae587edf6ffea0",
      "serverId": "e9e9afe9-4712-486d-8885-f54b72dd1951",
      "unresolved": false
    }
  ]
}